
Select distinct T2.ID2, Sum(T1.ID1) Over(PARTITION by T2.ID2)
from Table1 T1
join Table2 T2 on T1.ID1 = T2.ID2


SELECT Customercity, 
       SUM(Orderamount) OVER(PARTITION BY Customercity) TotalOrderAmount
FROM [dbo].[Orders];
